{% with messages = get_flashed_messages() %}
{% if messages %}
{% for message in messages %}
<div class="w3-panel w3-red w3-display-container w3-center" style="z-index:10">
  <span onclick="this.parentElement.style.display='none'"
    class="w3-button w3-red w3-hover-red w3-large w3-display-topright">&times;</span>
  <!-- VULNERABILITY FIX: Cross-Site Scripting (XSS) -->
  <!-- ASVS 5.0 5.3.3: Verify that context-aware output encoding is used. -->
  <!-- PREVIOUSLY: Flash messages were marked safe. -->
  <!-- NOW: Auto-escaping enabled. -->
  <p>{{ message }}</p>
</div>
{% endfor %}
{% endif %}
{% endwith %}